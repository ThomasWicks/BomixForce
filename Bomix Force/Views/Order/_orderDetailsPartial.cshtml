@model Bomix_Force.ViewModels.OrderViewModel

<div class="modal fade" id="duplicateModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h4 class="modal-title float-left text-white">Duplicar Pedido</h4>
                <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <h5 class="text-center"><strong>Numero do Pedido: @Model.Pedido</strong></h5>
                <div class="table-responsive mt-2">
                    <table id="#tableOrder" class="table table-striped">
                        <thead class="thead-light">

                            <tr>
                                <th class="text-center">
                                    Produto
                                </th>
                                <th class="text-center">
                                    Quantidade
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var SubItem in Model.Item)
                            {
                                <tr>
                                    @if (@SubItem.Produto != "")
                                    {
                                        <th class="text-center ">
                                            @SubItem.Produto
                                        </th>

                                    }
                                    else
                                    {
                                        <th class="text-center ">
                                            -
                                        </th>
                                    }
                                    @if (@SubItem.Quantidade != 0)
                                    {
                                        <th class="text-center ">
                                            @SubItem.Quantidade
                                        </th>

                                    }
                                    else
                                    {
                                        <th class="text-center ">
                                            -
                                        </th>
                                    }

                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <button data-dismiss="modal" class="btn btn-danger">Cancelar</button>
                <button type="button" onclick="duplicate(@Model.Pedido)" class="btn btn-primary btn-lg fas fa-copy float-right">  Duplicar</button>
            </div>

        </div>

    </div>


</div>
<script>
    function duplicate(Pedido) {
        $('#duplicateModal').modal('hide');
        document.getElementById('loadingSpinnerOverlay').style.display='block'
        $.ajax({
            url: 'Duplicate',
            data: {
                Pedido: Pedido
            },
            complete: function (e, xhr, settings) {
                document.getElementById('loadingSpinnerOverlay').style.display = 'none'
                if(e.status === 200){
                    toastr.success("Requisição para repetir o pedido enviada com sucesso", "Pedido");
                }else{
                    toastr.error("Ocorreu uma falha na duplicação do pedido", "Pedido");
                }
            },
            method: 'Post',
            dataType: 'json',
        })
    }

</script>
